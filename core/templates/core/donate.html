{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Donate</title>
    <link rel="stylesheet" href="{% static 'core/donate.css' %}">
</head>
<body>
<nav class="navbar">
    <a href="{% url 'home' %}">Home</a>
    <a href="{% url 'about' %}">About</a>
    <a href="{% url 'blogs' %}">Blogs</a>
    <a href="{% url 'donate' %}">Donate</a>
    <a href="{% url 'campaigns' %}">Campaigns</a>
    <a href="{% url 'feedback' %}">Feedback</a>
    <a href="{% url 'help' %}">Help</a>
    <a href="{% url 'login' %}">Login</a>
</nav>

<div class="donate-container">
    <h2>Make a Donation</h2>
    <form id="donateForm">
        <input type="text" id="name" placeholder="Your Name" required />
        <input type="email" id="email" placeholder="Your Email" required />
        <input type="number" id="amount" placeholder="Donation Amount (â‚¹)" required />

        <select id="paymentMethod" required onchange="togglePaymentFields()">
            <option value="">Select Payment Method</option>
            <option value="cash">Cash</option>
            <option value="upi">UPI</option>
            <option value="card">Card</option>
        </select>

        <!-- UPI Section -->
        <div id="upiSection" class="hidden">
            <p>Use UPI ID: <strong>ngo@upi</strong></p>
            <img src="{% static 'core/upi-qr.png' %}" alt="UPI QR Code" style="width: 200px;" />
        </div>

        <!-- Card Section -->
        <div id="cardSection" class="hidden">
            <input type="text" id="cardNumber" placeholder="Card Number" />
            <input type="text" id="expiry" placeholder="Expiry (MM/YY)" />
            <input type="text" id="cvv" placeholder="CVV" />
        </div>

        <textarea id="address" placeholder="YOUR ADDRESS"></textarea>
        <button type="submit">Donate</button>
    </form>
</div>

<!-- Firebase Scripts -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCFERIhqIiwTOhDSC_w5Zm3WdiasDgqgfE",
        authDomain: "fir-441fd.firebaseapp.com",
        databaseURL: "https://fir-441fd-default-rtdb.firebaseio.com",
        projectId: "fir-441fd",
        storageBucket: "fir-441fd.appspot.com",
        messagingSenderId: "211335511072",
        appId: "1:211335511072:web:e32b18a89d642ed3b7d045"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const upiSection = document.getElementById("upiSection");
    const cardSection = document.getElementById("cardSection");

    // Hide both sections on page load
    window.addEventListener("DOMContentLoaded", () => {
        upiSection.style.display = "none";
        cardSection.style.display = "none";
    });

    function togglePaymentFields() {
        const method = document.getElementById("paymentMethod").value;
        upiSection.style.display = method === "upi" ? "block" : "none";
        cardSection.style.display = method === "card" ? "block" : "none";
    }

    document.getElementById("donateForm").addEventListener("submit", function(e) {
        e.preventDefault();

        const name = document.getElementById("name").value;
        const email = document.getElementById("email").value;
        const amount = document.getElementById("amount").value;
        const method = document.getElementById("paymentMethod").value;
        const address = document.getElementById("address").value;

        let donationData = {
            name,
            email,
            amount,
            method,
            address,
            timestamp: new Date().toISOString()
        };

        if (method === "card") {
            donationData.cardDetails = {
                cardNumber: document.getElementById("cardNumber").value,
                expiry: document.getElementById("expiry").value,
                cvv: document.getElementById("cvv").value
            };
        }

        db.ref("donations").push(donationData);

        alert("Thank you for your donation!");
        document.getElementById("donateForm").reset();
        togglePaymentFields(); // re-hide sections
    });
</script>
</body>
</html>